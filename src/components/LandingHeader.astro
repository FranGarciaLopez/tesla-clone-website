---
import Logo from "../components/Logo.astro";
---

<header
	id="landing-header"
	class="py-4 px-6 flex items-center fixed top-0 w-full justify-between text-current z-40"
>
	<div class="flex flex-grow basis-0">
		<Logo />
	</div>

	<button
		id="menu-button"
		class="xl:hidden fixed top-5 right-5 flex items-center px-3 py-2 rounded text-sm text-current bg-black/20 backdrop-blur-lg z-50"
	>
		Menú
	</button>

	<nav
		id="primary-menu"
		class="fixed top-0 hidden h-full w-full bg-white z-50 text-xs xl:relative xl:block xl:h-auto xl:bg-transparent xl:z-auto xl:flex xl:flex-grow xl:justify-center xl:px-4 xl:py-2"
	>
		<button
			id="close-menu"
			class="xl:hidden fixed top-5 right-5 flex items-center px-3 py-2 rounded text-sm text-current bg-black/20 backdrop-blur-lg z-50"
		>
			Cerrar
		</button>

		<ul
			class="flex flex-col items-start justify-center h-full text-black px-0 gap-10 xl:flex xl:flex-row xl:basis-0 xl:flex-grow xl:text-sm xl:text-current xl:justify-center xl:items-center [&>li>a]:transition-colors [&>li>a]:duration-200 [&>li>a]:inline-block text-center [&>li>a]:px-4 py-2"
		>
			<li>
				<a href="#">Vehículos</a>
				<div class="hover:w-screen hover:h-[50%]">
					<article class="grid grid-col-3">

					</article>
				</div>
			</li>
			<li>
				<a href="#">Energía</a>
			</li>
			<li>
				<a href="#">Carga</a>
			</li>
			<li>
				<a href="#">Distribuir</a>
			</li>
			<li>
				<a href="#">Tienda</a>
			</li>
		</ul>
	</nav>

	<nav
		id="secondary-menu"
		class="fixed top-0 left-0 hidden h-full w-full bg-white z-50 xl:static xl:h-auto xl:w-auto xl:bg-transparent xl:z-auto xl:flex xl:flex-grow xl:justify-end xl:px-4 xl:py-2"
	>
		<ul
			class="flex flex-col items-end justify-end h-full text-black xl:flex xl:flex-row xl:basis-0 xl:space-around xl:text-xs xl:text-current [&>li>a]:transition-colors [&>li>a]:duration-200 [&>li>a]:inline-block text-center [&>li>a]:px-4 py-2"
		>
			<li>
				<a href="#"
					><svg
						class="w-5 h-5 text-current"
						aria-hidden="true"
						xmlns="http://www.w3.org/2000/svg"
						fill="none"
						viewBox="0 0 20 20"
					>
						<path
							stroke="currentColor"
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="1.25"
							d="M7.529 7.988a2.502 2.502 0 0 1 5 .191A2.441 2.441 0 0 1 10 10.582V12m-.01 3.008H10M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"
						></path>
					</svg></a
				>
			</li>
			<li>
				<a href="#"
					><svg
						class="w-5 h-5 text-current"
						aria-hidden="true"
						xmlns="http://www.w3.org/2000/svg"
						fill="none"
						viewBox="0 0 21 20"
					>
						<path
							stroke="currentColor"
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="1.25"
							d="M6.487 1.746c0 4.192 3.592 1.66 4.592 5.754 0 .828 1 1.5 2 1.5s2-.672 2-1.5a1.5 1.5 0 0 1 1.5-1.5h1.5m-16.02.471c4.02 2.248 1.776 4.216 4.878 5.645C10.18 13.61 9 19 9 19m9.366-6h-2.287a3 3 0 0 0-3 3v2m6-8a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"
						></path>
					</svg></a
				>
			</li>
			<li>
				<a href="#"
					><svg
						class="w-5 h-5 text-current"
						aria-hidden="true"
						xmlns="http://www.w3.org/2000/svg"
						fill="none"
						viewBox="0 0 20 20"
					>
						<path
							stroke="currentColor"
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="1.25"
							d="M10 19a9 9 0 1 0 0-18 9 9 0 0 0 0 18Zm0 0a8.949 8.949 0 0 0 4.951-1.488A3.987 3.987 0 0 0 11 14H9a3.987 3.987 0 0 0-3.951 3.512A8.948 8.948 0 0 0 10 19Zm3-11a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"
						></path>
					</svg></a
				>
			</li>
		</ul>
	</nav>

	<!-- Menu Backdrop -->
	<div
		id="menu-backdrop"
		class="absolute bg-black/30 backdrop-blur-lg rounded translate-x-[var(--left)] translate-y-[var(--top)] top-0 left-0 w-[var(--width)] h-[var(--height)] transition-all duration-300 ease-in-out opacity-0 -z-10"
	>
	</div>
</header>

<script>
	document.getElementById("menu-button").addEventListener(
		"click",
		function () {
			document.getElementById(
				"primary-menu",
			).classList.toggle("hidden");
		},
	);

	document.getElementById("close-menu").addEventListener(
		"click",
		function () {
			document.getElementById(
				"primary-menu",
			).classList.add("hidden");
		},
	);
</script>

<script>
	const listItem = document.querySelectorAll("#landing-header li");
	const menuBackdrop = document.querySelector(
		"#menu-backdrop",
	) as HTMLElement;

	listItem.forEach((item) => {
		item.addEventListener("mouseenter", () => {
			const { left, top, width, height } =
				item.getBoundingClientRect();

			menuBackdrop.style.setProperty(
				"--left",
				`${left}px`,
			);
			menuBackdrop.style.setProperty(
				"--top",
				`${top}px`,
			);
			menuBackdrop.style.setProperty(
				"--width",
				`${width}px`,
			);
			menuBackdrop.style.setProperty(
				"--height",
				`${height}px`,
			);
			menuBackdrop.style.opacity = "1";
			menuBackdrop.style.visibility = "visible";
		});

		item.addEventListener("mouseleave", () => {
			menuBackdrop.style.opacity = "0";
			menuBackdrop.style.visibility = "hidden";
		});
	});
</script>

<script>
	const $header = document.querySelector(
		"#landing-header",
	) as HTMLElement;

	const observerOptions = {
		root: null,
		rootMargin: "0px",
		threshold: 0.9,
	};

	const observer = new IntersectionObserver((entries) => {
		entries.forEach((entry) => {
			const { isIntersecting } = entry;

			if (isIntersecting) {
				const color =
					entry.target.getAttribute(
						"data-header-color",
					);

				$header.style.color = color;
			}
		});
	}, observerOptions);

	const $sections = document.querySelectorAll(".landing-section");
	$sections.forEach((section) => observer.observe(section));
</script>
